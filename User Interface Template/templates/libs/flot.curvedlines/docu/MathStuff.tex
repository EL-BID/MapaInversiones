\documentclass[a4paper]{article***REMOVED***
\usepackage[english]{babel***REMOVED***
\usepackage[utf8]{inputenc***REMOVED***
\usepackage[fleqn]{amsmath***REMOVED***
\usepackage{hyperref***REMOVED***

\begin{document***REMOVED***

\section{Math stuff***REMOVED***

Cubic interpolation for one segment $[x_k, x_{k+1***REMOVED***]$ can be described as:

\begin{equation****REMOVED***
	\begin{aligned***REMOVED***
		f(t) &= c_{oef1***REMOVED***t^3 + c_{oef2***REMOVED***t^2 + c_{oef3***REMOVED***t + c_{oef4***REMOVED***  \hspace{1cm***REMOVED*** with \\
		t(x) &= \frac{x - x_k***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED***
	\end{aligned***REMOVED***
\end{equation****REMOVED***

\hspace{1cm***REMOVED*** and

\begin{equation****REMOVED***
	\begin{aligned***REMOVED***
		c_{oef1***REMOVED*** &= 2p_0 - 2p_1 - m_0 - m_1 \\
		c_{oef2***REMOVED*** &= -3p_0 + 3p_1 - 2m_0 - m_1 \\
		c_{oef3***REMOVED*** &= m_0 \\
		c_{oef4***REMOVED*** &= p_0
	\end{aligned***REMOVED***
\end{equation****REMOVED***


(see Wikipedia-Links below)\\
\\
If we rewrite this as function of $d = x - x_k$ we get

\begin{equation****REMOVED***
	\begin{aligned***REMOVED***
		f'(d) &= c_{oef1***REMOVED***' d^3 + c_{oef2***REMOVED***' d^2 + c_{oef3***REMOVED***' d + c_{oef4***REMOVED***' \hspace{1cm***REMOVED*** with \\
		c_{oef1***REMOVED***' &= \frac{c_{oef1***REMOVED******REMOVED***{(x_{k+1***REMOVED*** - x_k)^3***REMOVED*** \\
        c_{oef2***REMOVED***' &= \frac{c_{oef2***REMOVED******REMOVED***{(x_{k+1***REMOVED*** - x_k)^2***REMOVED*** \\
        c_{oef3***REMOVED***' &= \frac{c_{oef3***REMOVED******REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** \\
        c_{oef4***REMOVED***' &= c_{oef4***REMOVED***
    \end{aligned***REMOVED***
\end{equation****REMOVED***
\\
The implemented algorithm uses two helper variables to calculate the coefficients of $f'$ efficiently:

\begin{equation****REMOVED***
	\begin{aligned***REMOVED***
		common = m_k + m_{k+1***REMOVED*** - 2 \frac{p_{k+1***REMOVED*** - p_k***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** \\
		invLength = \frac{1***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED***
    \end{aligned***REMOVED***
\end{equation****REMOVED***
\\
We use $p_0 = p_k$, $p_1 = p_{k+1***REMOVED***$, $m_0 = m_k (x_{k+1***REMOVED*** - x_k)$, $m_1 = m_{k+1***REMOVED*** (x_{k+1***REMOVED*** - x_k)$ and $s = \frac{p_{k+1***REMOVED***-p_k***REMOVED***{x_{k+1***REMOVED***-x_k***REMOVED***$. The tangents are scaled with the length of the segment. \\
\\
If we insert this into the equations for the coefficients we get the formulas that are used in the algorithm:

\begin{equation****REMOVED***
\begin{aligned***REMOVED***
	c_{oef1***REMOVED***' &= \frac{c_{oef1***REMOVED******REMOVED***{(x_{k+1***REMOVED*** - x_k)^3***REMOVED*** \\
	&= \frac{2p_0 - 2p_1 + m_0 + m_1***REMOVED***{(x_{k+1***REMOVED*** - x_k)^3***REMOVED***\\
	&= (2p_k - 2p_{k+1***REMOVED*** + m_k (x_{k+1***REMOVED*** - x_k) + m_{k+1***REMOVED*** (x_{k+1***REMOVED*** - x_k) / (x_{k+1***REMOVED*** - x_k)^3 \\
	&= \frac {(2p_k - 2p_{k+1***REMOVED*** + m_k (x_{k+1***REMOVED*** - x_k) + m_{k+1***REMOVED*** (x_{k+1***REMOVED*** - x_k)***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** / (x_{k+1***REMOVED*** - x_k)^2 \\
	&= (\frac {2p_k - 2p_{k+1***REMOVED******REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** + m_k + m_{k+1***REMOVED***  ) * invLength^2 \\
	&= (-2\frac {p_{k+1***REMOVED***- p_k***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** + m_k + m_{k+1***REMOVED***  ) * invLength^2 \\
	&= common * invLenght^2
\end{aligned***REMOVED***
\end{equation****REMOVED***
 
\begin{equation****REMOVED***
\begin{aligned***REMOVED***
	c_{oef2***REMOVED***' &= \frac{c_{oef2***REMOVED******REMOVED***{(x_{k+1***REMOVED*** - x_k)^2***REMOVED*** \\
	&= (-3p_0 + 3p_1 - 2m_0 - m_1) / (x_{k+1***REMOVED*** - x_k)^2 \\
	&= (-3p_k + 3p_{k+1***REMOVED*** - 2* m_k (x_{k+1***REMOVED*** - x_k) - m_{k+1***REMOVED*** (x_{k+1***REMOVED*** - x_k)) / (x_{k+1***REMOVED*** - x_k)^2 \\
	&= (\frac{-3p_k + 3p_{k+1***REMOVED******REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** - 2m_k - m_{k+1***REMOVED***) * invLenght \\
	&= (3\frac{p_{k+1***REMOVED*** - p_k***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** - 2m_k - m_{k+1***REMOVED***) * invLenght \\
	&=(\frac{p_{k+1***REMOVED*** - p_k***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** + 2\frac{p_{k+1***REMOVED*** - p_k***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** - m_k - m_{k+1***REMOVED*** - m_k) * invLenght \\
	&= (s - common - m_k) * invLenght  
\end{aligned***REMOVED***    
\end{equation****REMOVED***
 
\begin{equation****REMOVED***
\begin{aligned***REMOVED***
	c_{oef3***REMOVED***' &= \frac{c_{oef3***REMOVED******REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** \\
	&= \frac{m_0***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** \\
	&= \frac{m_k (x_{k+1***REMOVED*** - x_k)***REMOVED***{x_{k+1***REMOVED*** - x_k***REMOVED*** \\
 	&= m_k
\end{aligned***REMOVED***
\end{equation****REMOVED***

\begin{equation****REMOVED***
\begin{aligned***REMOVED***
	c_{oef4***REMOVED***' &= c_{oef4***REMOVED*** = p_0 = p_k
\end{aligned***REMOVED***
\end{equation****REMOVED***

\section{Useful Links***REMOVED***

\url{http://de.wikipedia.org/w/index.php?title=Kubisch_Hermitescher_Spline&oldid=130168003)***REMOVED***\\
\url{http://en.wikipedia.org/w/index.php?title=Monotone_cubic_interpolation&oldid=622341725***REMOVED***\\
\url{http://math.stackexchange.com/questions/45218/implementation-of-monotone-cubic-interpolation***REMOVED***\\
\url{http://math.stackexchange.com/questions/4082/equation-of-a-curve-given-3-points-and-additional-constant-requirements#4104***REMOVED***

\end{document***REMOVED***