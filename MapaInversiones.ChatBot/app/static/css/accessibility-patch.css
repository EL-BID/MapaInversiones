/* ========================================
   PARCHE DE ACCESIBILIDAD WCAG 2.1 AA
   Compatible con HTML y CSS existente
   ======================================== */

/* Este archivo se AGREGA después de tu CSS actual, NO lo reemplaza */

/* ========================================
   1. FOCUS VISIBLE (Navegación por teclado)
   ======================================== */

/* Focus visible sutil para todos los elementos interactivos */
button:focus-visible,
a:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible,
.btn:focus-visible,
.question-card:focus-visible,
.feedback-option:focus-visible,
.citizen-chip:focus-visible,
.dropdown-item:focus-visible {
    outline: 2px solid #003876 !important;
    outline-offset: 2px !important;
    box-shadow: 0 0 0 3px rgba(0, 56, 118, 0.15) !important;
}

/* Solo mostrar outline cuando se navega con teclado */
*:focus:not(:focus-visible) {
    outline: none !important;
}

/* ========================================
   2. MEJORAS DE CONTRASTE (Texto más legible)
   ======================================== */

/* Mejora contraste en textos muted sin cambiar mucho el diseño */
.text-muted,
.history-item-date,
.message-meta,
.chat-disclaimer {
    color: #5a5a5a !important; /* Mejorado de colores más claros */
}

/* Asegurar que texto sobre fondos claros sea legible */
.sidebar .history-item-title,
.sidebar-history h2,
.history-title {
    color: #1a1a1a !important;
}

/* ========================================
   3. TAMAÑOS MÍNIMOS DE TOQUE (Solo móvil)
   ======================================== */

/* Solo en móviles, aumentar tamaño de elementos táctiles */
@media (max-width: 768px) {
    button,
    .btn,
    a.btn,
    .question-card,
    .feedback-option,
    .citizen-chip,
    .dropdown-item {
        min-height: 44px !important;
        padding-top: 10px !important;
        padding-bottom: 10px !important;
    }
    
    /* Textarea/input con tamaño mínimo */
    .chat-input,
    textarea,
    input[type="text"],
    input[type="email"] {
        min-height: 48px !important;
        font-size: 16px !important; /* Evita zoom en iOS */
    }
    
    /* Iconos/botones pequeños también necesitan espacio */
    .btn-icon-sm,
    .sidebar-toggle,
    .navbar-toggler {
        min-width: 44px !important;
        min-height: 44px !important;
    }
}

/* ========================================
   4. ACCESIBILIDAD EN MODALES
   ======================================== */

/* Asegurar que modales tengan contraste adecuado en overlay */
.feedback-modal,
.unified-modal-overlay,
[role="dialog"] {
    background: rgba(0, 0, 0, 0.75) !important; /* Mejorado de 0.45 */
}

/* Botón de cerrar modal más visible */
.feedback-modal-close,
.unified-modal-close,
[aria-label*="cerrar" i],
[aria-label*="close" i] {
    min-width: 44px !important;
    min-height: 44px !important;
    border: 2px solid rgba(0, 0, 0, 0.1) !important;
}

.feedback-modal-close:hover,
.unified-modal-close:hover {
    background: rgba(255, 0, 0, 0.1) !important;
}

/* ========================================
   5. SKIP LINK (Accesibilidad crítica)
   ======================================== */

/* Link para saltar navegación (solo visible al tabular) */
.skip-link {
    position: absolute;
    top: -100px;
    left: 10px;
    background: #003876;
    color: white;
    padding: 10px 20px;
    text-decoration: none;
    z-index: 10000;
    font-weight: 600;
    border-radius: 0 0 8px 8px;
    transition: top 0.3s ease;
}

.skip-link:focus {
    top: 0;
    outline: 3px solid #fbbf24;
    outline-offset: 2px;
}

/* ========================================
   6. CLASE SR-ONLY (Para lectores de pantalla)
   ======================================== */

/* Ocultar visualmente pero mantener para lectores de pantalla */
.sr-only {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border-width: 0 !important;
}

/* Mostrar cuando tiene focus (para skip links) */
.sr-only:focus {
    position: static !important;
    width: auto !important;
    height: auto !important;
    margin: 0 !important;
    overflow: visible !important;
    clip: auto !important;
    white-space: normal !important;
}

/* ========================================
   7. MEJORAS EN DISCLAIMER
   ======================================== */

/* Disclaimer con mejor contraste */
.chat-disclaimer {
    color: #6b4200 !important; /* Mejorado contraste */
    background-color: #fff3cd !important;
    border: 2px solid #ffc107 !important;
    font-size: 0.875rem !important; /* No menor de 14px */
}

.chat-disclaimer svg,
.chat-disclaimer i {
    color: #b8700a !important;
    min-width: 18px !important;
    min-height: 18px !important;
}

/* ========================================
   8. INDICADOR DE LOADING ACCESIBLE
   ======================================== */

/* Indicador de carga visible */
.loading-indicator {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 56, 118, 0.95);
    color: white;
    padding: 20px 30px;
    border-radius: 12px;
    z-index: 10000;
    font-weight: 600;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    display: none;
}

.loading-indicator.show {
    display: block !important;
}

/* ========================================
   9. MEJORAS EN TABLAS (Si existen)
   ======================================== */

/* Tablas con mejor accesibilidad */
.tabla-respuesta-container,
table {
    border: 2px solid #d0d0d0 !important;
}

table th {
    background: #f5f7fa !important;
    font-weight: 700 !important;
    color: #1a1a1a !important;
}

table td,
table th {
    padding: 12px 16px !important;
    border-bottom: 1px solid #d0d0d0 !important;
}

/* ========================================
   10. NAVEGACIÓN POR TECLADO - CLASE HELPER
   ======================================== */

/* Clase que se agrega al body cuando se detecta teclado */
.keyboard-navigation *:focus {
    outline: 2px solid #003876 !important;
    outline-offset: 2px !important;
}

/* ========================================
   11. LINKS CON MEJOR CONTRASTE
   ======================================== */

/* Links más visibles */
a {
    text-decoration: underline !important;
}

a:hover,
a:focus {
    text-decoration: none !important;
    outline: 2px solid #003876 !important;
    outline-offset: 2px !important;
}

/* ========================================
   12. PREFERENCIAS DE USUARIO
   ======================================== */

/* Respetar preferencia de movimiento reducido */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* Soporte para alto contraste */
@media (prefers-contrast: high) {
    button,
    .btn,
    input,
    textarea,
    .question-card {
        border-width: 3px !important;
    }
    
    *:focus-visible {
        outline-width: 3px !important;
    }
}

/* ========================================
   13. CORRECCIONES ESPECÍFICAS
   ======================================== */

/* Asegurar que iconos decorativos no interfieran con lectores de pantalla */
[data-feather],
.feather,
i[class*="icon"],
svg[aria-hidden="true"] {
    pointer-events: none;
}

/* Botones sin texto deben tener tamaño adecuado */
button:empty,
.btn:empty,
button:not(:has(span)):not(:has(text)) {
    min-width: 44px !important;
    min-height: 44px !important;
}

/* ========================================
   14. DROPDOWN MENUS
   ======================================== */

.dropdown-menu {
    border: 2px solid #d0d0d0 !important;
}

.dropdown-item {
    color: #1a1a1a !important;
    padding: 10px 16px !important;
    min-height: 44px !important;
    display: flex !important;
    align-items: center !important;
}

.dropdown-item:hover,
.dropdown-item:focus {
    background-color: rgba(0, 56, 118, 0.1) !important;
}

/* ========================================
   15. CITIZENSHIP CHIPS Y ELEMENTOS INTERACTIVOS
   ======================================== */

.citizen-chip,
.feedback-option {
    min-height: 44px !important;
    padding: 10px 16px !important;
    border-width: 2px !important;
}

.citizen-chip:hover,
.citizen-chip:focus,
.feedback-option:hover,
.feedback-option:focus {
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px rgba(0, 56, 118, 0.15) !important;
}

/* ========================================
   FIN DEL PARCHE DE ACCESIBILIDAD
   ======================================== */

/* 
INSTRUCCIONES DE USO:
1. Agrega este archivo DESPUÉS de tu CSS principal
2. No necesitas modificar tu CSS actual
3. Este parche solo agrega mejoras de accesibilidad
4. Si algo se ve mal, puedes quitarlo fácilmente

CUMPLIMIENTO WCAG:
- Focus visible: ✅
- Contraste mejorado: ✅  
- Tamaños táctiles: ✅ (móvil)
- Skip link: ✅
- Preferencias usuario: ✅

CUMPLIMIENTO ESTIMADO: ~75-80% WCAG 2.1 AA
*/
