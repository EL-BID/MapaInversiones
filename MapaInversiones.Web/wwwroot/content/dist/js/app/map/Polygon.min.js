define(["lib/mvc/Observable","./Infobox"],function(n,t){function u(n,t){var i,e,o=[],r,u,f;if(t)for(r=[n[1],n[0]],u=r,f=Math.min(n.length),i=0,e=0;i<f;i+=2,e++)o[e]=new Microsoft.Maps.Location(n[i+1],n[i]),r=[Math.min(r[0],n[i+1]),Math.min(r[1],n[i])],u=[Math.max(u[0],n[i+1]),Math.max(u[1],n[i])];else for(r=[n[0][0][1],n[0][0][0]],u=r,f=Math.min(n[0].length),i=0;i<f;i++)o[i]=new Microsoft.Maps.Location(n[0][i][1],n[0][i][0]),r=[Math.min(r[0],n[0][i][1]),Math.min(r[1],n[0][i][0])],u=[Math.max(u[0],n[0][i][1]),Math.max(u[1],n[0][i][0])];return{locations:o,leftTopPoint:r,rightBottomPoint:u}}function r(n){var t=n.match(/\d+(?:\.\d+)?/g);return new Microsoft.Maps.Color(~~(t[3]*255),t[0],t[1],t[2])}var i=new Class(n,{initialize:function(n,t,u,f,e){var h=r("rgba("+i.baseRGB+",0.55)"),c=r("rgba("+i.strokeRGB+",1)"),l=t.strokeThickness||1,o=[],s;this._highlightColor=r("rgba("+i.baseRGB+",0)"),this._fillColor=t.fillColor?r(t.fillColor):h,this._strokeColor=t.strokeColor?r(t.strokeColor):c,s={fillColor:this._fillColor,strokeColor:this._strokeColor,strokeThickness:l},e!="municipalities"?o=this.generatePolygon(t.coords,u):(this.coords=t.coords,this.isLight=u),this._polygon=new Microsoft.Maps.Polygon(o,s),this._polygon.Polygon=this,Microsoft.Maps.Events.addHandler(this._polygon,"mouseover",this.highlightPolygon.bind(this)),Microsoft.Maps.Events.addHandler(this._polygon,"mouseout",this.restorePolygon.bind(this)),window.test=this._polygon,this.config=t,this.id=f,this.type=e,this._map=n,this.createInfobox()},generatePolygon:function(n,t){var i,r=typeof n=="undefined";if(!this.generated)if(n=n||this.coords,t=t||this.isLight,i=u(n,t),this._leftTopPoint=i.leftTopPoint,this._rightBottomPoint=i.rightBottomPoint,this._leftTopPoint=[this._leftTopPoint[0],this._leftTopPoint[1]],this._center=new Microsoft.Maps.Location((this._leftTopPoint[0]+this._rightBottomPoint[0])/2,(this._leftTopPoint[1]+this._rightBottomPoint[1])/2),this.coords=void 0,this.isLight=void 0,this.generated=!0,r)this._polygon.setLocations(i.locations);else return i.locations},highlightPolygon:function(){this._polygon.setOptions({fillColor:this._highlightColor,strokeThickness:2})},restorePolygon:function(){this._polygon.setOptions({fillColor:this._fillColor,strokeThickness:1})},getCoordinates:function(){return this.generated||this.generatePolygon(this.coords,this.isLight),[new Microsoft.Maps.Location(this._leftTopPoint[0],this._leftTopPoint[1]-(this._rightBottomPoint[1]-this._leftTopPoint[1])/2),new Microsoft.Maps.Location(this._rightBottomPoint[0],this._rightBottomPoint[1])]},setCoordinates:function(n,t){this._leftTopPoint=n,this._rightBottomPoint=t},hide:function(){this._polygon.setOptions({visible:!1}),this._infobox.hide()},show:function(){this._polygon.setOptions({visible:!0})},getPolygon:function(){return this.generatePolygon(),this._polygon},getInfobox:function(){return this._infobox},createInfobox:function(){return this._infobox=new t("info",this._map,this,this.config.content),this._polygon.setOptions({infobox:this._infobox}),this._infobox},updateInfobox:function(n){return this._infobox.updateContent(n),this._infobox},panIntoView:function(){var n=this.getCoordinates(),t=new Microsoft.Maps.LocationRect.fromCorners(n[0],n[1]);this._map.setView({bounds:t})},updateColor:function(n){this._fillColor=this._strokeColor=r(n),this._polygon.setOptions({fillColor:this._fillColor})},select:function(){this.fireEvent("selected",this.id,this.type)}});return i.baseRGB="200, 187, 137",i.strokeRGB="180, 160, 125",i});
//@ sourceMappingURL=Polygon.min.js.map