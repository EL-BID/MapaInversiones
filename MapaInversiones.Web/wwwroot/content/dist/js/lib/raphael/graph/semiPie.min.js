(function(){function n(n,t,i,r,u,f,e){function ft(n,t,i,r,u){var f=Math.PI/180,o=n+i*Math.cos(-r*f),v=n+i/1.35*Math.cos((-r-u)/2*f),s=n+i*Math.cos(-u*f),y=n+i/2*Math.cos(-(r+(u-r)/2)*f),h=t+i*Math.sin(-r*f),p=t+i/1.35*Math.sin((-r-u)/2*f),c=t+i*Math.sin(-u*f),w=t+i/2*Math.sin(-(r+(u-r)/2)*f),l=(n+o)/2,a=(t+h)/2,b=(n+s)/2,k=(t+c)/2,e=["M",l,a,"L",o,h,"A",i,i,0,+(Math.abs(u-r)>180),1,s,c,"L",b,k,"A",i/2,i/2,0,+(Math.abs(u-r)>180),0,l,a,"z"];return e.middle={x:y,y:w},e.realMiddle={x:v,y:p},e}var o,b,et,ot;f=f||{};var w=this,tt=[],l=n.set(),s=n.set(),a=n.set(),v=u.length,y=f.startFromFixedAngle||0,h=0,it=0,p=f.maxSlices||100,rt=parseFloat(f.minPercent)||1,d=Boolean(rt),ut,g=0;if(s.covers=l,v==1)a.push(n.circle(t,i,r).attr({fill:f.colors&&f.colors[0]||w.colors[0],stroke:f.stroke||"#fff","stroke-width":f.strokewidth==null?1:f.strokewidth})),l.push(n.circle(t,i,r).attr(w.shim)),h=u[0],u[0]={value:u[0],order:0,valueOf:function(){return this.value}},f.href&&f.href[0]&&l[0].attr({href:f.href[0]}),a[0].middle={x:t,y:i},a[0].mangle=180;else{for(o=0;o<v;o++)h+=u[o],u[o]={value:u[o],order:o,valueOf:function(){return this.value}};for(u.sort(function(n,t){return t.value-n.value}),e&&e.sort(function(n,t){return parseInt(t,10)-parseInt(n,10)}),o=0;o<v;o++)d&&u[o]*100/h<rt&&(p=o,d=!1),o>p&&(d=!1,u[p].value+=u[o],u[p].others=!0,it=u[p].value);for(v=Math.min(p+1,u.length),it&&u.splice(v)&&(u[p].others=!0),o=0;o<v;o++){f.startFromFixedAngle?b=y+360*u[o]/h/2:(b=y-360*u[o]/h/2,o||(y=90-b,b=y-360*u[o]/h/2)),f.init&&(et=ft(t,i,1,y,y-360*u[o]/h).join(","));var k=ft(t,i,r,y,y-=360*u[o]/h),nt=f.matchColors&&f.matchColors==!0?u[o].order:o,c=n.path(f.init?et:k).attr({fill:f.colors&&f.colors[nt]||w.colors[nt]||"#666",stroke:f.stroke&&f.stroke[nt]||"#fff","stroke-width":f.strokewidth==null?1:f.strokewidth,"stroke-linejoin":"round"});c.value=u[o],c.middle=k.middle,c.mangle=b,tt.push(c),a.push(c),f.labels&&(g=c.value.value/h*100,ut=e?e[o]:(Math.round(g)+"%").replace(".",","),g>7&&n.text(k.realMiddle.x,k.realMiddle.y,ut).attr({"text-anchor":"middle",stroke:"transparent","stroke-width":0,fill:"#fff",opacity:.9,"font-size":"18px"})),f.init&&c.animate({path:k.join(",")},+f.init-1||1e3,">")}for(o=0;o<v;o++)c=n.path(tt[o].attr("path")).attr(w.shim),f.href&&f.href[o]&&c.attr({href:f.href[o]}),c.attr=function(){},l.push(c),a.push(c)}return s.hover=function(n,f){var o,e;for(f=f||function(){},o=this,e=0;e<v;e++)(function(e,s,c){var l={sector:e,cover:s,cx:t,cy:i,mx:e.middle.x,my:e.middle.y,mangle:e.mangle,r:r,value:u[c],total:h,label:o.labels&&o.labels[c]};s.mouseover(function(){n.call(l)}).mouseout(function(){f.call(l)})})(a[e],l[e],e);return this},s.each=function(n){for(var e=this,f=0;f<v;f++)(function(f,o,s){var c={sector:f,cover:o,cx:t,cy:i,x:f.middle.x,y:f.middle.y,mangle:f.mangle,r:r,value:u[s],total:h,label:e.labels&&e.labels[s]};n.call(c)})(a[f],l[f],f);return this},s.click=function(n){for(var e=this,f=0;f<v;f++)(function(f,o,s){var c={sector:f,cover:o,cx:t,cy:i,mx:f.middle.x,my:f.middle.y,mangle:f.mangle,r:r,value:u[s],total:h,label:e.labels&&e.labels[s]};o.click(function(){n.call(c)})})(a[f],l[f],f);return this},s.inject=function(n){n.insertBefore(l[0])},ot=function(e,o,c,y){var g=t+r+r/5,rt=i,d=rt+10,p,nt,k,tt,b,it;for(e=e||[],y=y&&y.toLowerCase&&y.toLowerCase()||"east",c=n[c&&c.toLowerCase()]||"circle",s.labels=n.set(),p=0;p<v;p++)nt=a[p].attr("fill"),k=u[p].order,u[p].others&&(e[k]=o||"Others"),e[k]=w.labelise(e[k],u[p],h),s.labels.push(n.set()),s.labels[p].push(n[c](g+5,d,5).attr({fill:nt,stroke:"none"})),s.labels[p].push(tt=n.text(g+20,d,e[k]||u[k]).attr(w.txtattr).attr({fill:f.legendcolor||"#000","text-anchor":"start"})),l[p].label=s.labels[p],d+=tt.getBBox().height*1.2;b=s.labels.getBBox(),it={east:[0,-b.height/2],west:[-b.width-2*r-20,-b.height/2],north:[-r-b.width/2,-r-b.height-10],south:[-r-b.width/2,r+10]}[y],s.labels.translate.apply(s.labels,it),s.push(s.labels)},f.legend&&ot(f.legend,f.legendothers,f.legendmark,f.legendpos),s.push(a,l),s.series=a,s.covers=l,s}var t=function(){};t.prototype=Raphael.g,n.prototype=new t,Raphael.fn.semiPiechart=function(t,i,r,u,f,e){return new n(this,t,i,r,u,f,e)}})();
//@ sourceMappingURL=semiPie.min.js.map