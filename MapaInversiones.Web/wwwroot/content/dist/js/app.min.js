define("lib/mvc/Observable",[],function(){var e=function(){this._events={}};return e.prototype.on=function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},e.prototype.removeObserver=function(e,t){var n;this._events[e]&&~(n=this._events[e].indexOf(t))&&this._events[e].splice(n,1)},e.prototype.fireEvent=function(e){if(!this._events[e])return;for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(null,[].slice.call(arguments,1))},e}),define("app/map/Infobox",["lib/mvc/Observable"],function(e){function r(e,n,r){this._polygon=n;var i=t[r.type]?t[r.type](r.content):r.content;this._elem=$(i).css({display:"none"}),this._elem.appendTo(document.body),Microsoft.Maps.Events.addHandler(this._polygon,"mouseover",$.proxy(this.show,this)),Microsoft.Maps.Events.addHandler(this._polygon,"mouseout",$.proxy(this.hide,this)),Microsoft.Maps.Events.addHandler(e,"mousemove",$.proxy(this.move,this))}var t={info:doT.compile($("#template-infobox-info")[0].innerHTML)},n=15;return r.prototype=new e,r.prototype.show=function(e){this._elem.css({display:"block",left:e.pageX,top:e.pageY}),this.visible=!0},r.prototype.move=function(e){this.visible&&this._elem.css({left:e.pageX+n,top:e.pageY+n})},r.prototype.hide=function(){this._elem.css({display:"none"}),this.visible=!1},r}),define("app/map/Polygon",["lib/mvc/Observable","./Infobox"],function(e,t){function n(e,n){var s=i("rgba(158,52,158,0.5)"),o=i("rgba(158,52,158,0.8)"),u=n.strokeThickness||1,a,f,l,c,h;this._fillColor=n.fillColor?i(n.fillColor):s,this._strokeColor=n.strokeColor?i(n.strokeColor):o,this._darkFillColor=this._fillColor.clone(),this._darkFillColor.a=245,h={fillColor:this._fillColor,strokeColor:this._strokeColor,strokeThickness:u},a=r(n.coords),this._leftTopPoint=a.leftTopPoint,this._rightBottomPoint=a.rightBottomPoint,this._polygon=new Microsoft.Maps.Polygon(a.locations,h),this._infobox=new t(e,this._polygon,{content:n.content,lat:this._rightBottomPoint[0],"long":(this._rightBottomPoint[1]+this._leftTopPoint[1])/2,type:"info"}),Microsoft.Maps.Events.addHandler(this._polygon,"mouseover",$.proxy(this.onMouseOver,this)),Microsoft.Maps.Events.addHandler(this._polygon,"mouseout",$.proxy(this.onMouseOut,this)),Microsoft.Maps.Events.addHandler(this._polygon,"click",$.proxy(this.click,this)),e.entities.push(this._polygon)}function r(e,t,n){var r,i=[];t=t||[e[0][0][1],e[0][0][0]],n=n||[e[0][0][1],e[0][0][0]];for(r=0;r<e[0].length;r++)i.push(new Microsoft.Maps.Location(e[0][r][1],e[0][r][0])),t=[Math.min(t[0],e[0][r][1]),Math.min(t[1],e[0][r][0])],n=[Math.max(n[0],e[0][r][1]),Math.max(n[1],e[0][r][0])];return{locations:i,leftTopPoint:t,rightBottomPoint:n}}function i(e){var t=e.match(/\d+(?:\.\d+)?/g);return new Microsoft.Maps.Color(~~(t[3]*255),t[0],t[1],t[2])}return n.prototype=new e,n.prototype.onMouseOver=function(){this._polygon.setOptions({fillColor:this._darkFillColor})},n.prototype.onMouseOut=function(){this._polygon.setOptions({fillColor:this._fillColor})},n.prototype.getCoordinates=function(){return[new Microsoft.Maps.Location(this._leftTopPoint[0],this._leftTopPoint[1]),new Microsoft.Maps.Location(this._rightBottomPoint[0],this._rightBottomPoint[1])]},n.prototype.click=function(e){return this.fireEvent("click",e,this)},n.prototype.hide=function(){this._polygon.setOptions({visible:!1}),this._infobox.hide()},n.prototype.show=function(){this._polygon.setOptions({visible:!0})},n}),define("app/map/MapView",["lib/mvc/Observable","app/map/Polygon"],function(e,t){function n(e){function a(){n=new Microsoft.Maps.Map(e,{credentials:"Ah7mafuzHQjBcBfHXRNcyucmUVbzczI7SPzmWvoXhIxnDH-4fUcSKiPpR2kcDZLn",zoom:o,showMapTypeSelector:!1}),Microsoft.Maps.Events.addHandler(n,"mousewheel",function(e){return e.handled=!0,!0}),n.setView({mapTypeId:Microsoft.Maps.MapTypeId.road}),$.ajax({url:"../js/data/departamentos.json",success:f})}function f(e){var t,r,i,s,o;for(s=0;s<e.features.length;s++){t=e.features[s],r=t.geometry.coordinates;if(t.geometry.type=="MultiPolygon")for(o=0;o<r[0].length;o++)l(r[o],t.properties);else l(r,t.properties)}n.setView({center:new Microsoft.Maps.Location(6.630819016887428,-77.40986328125)}),Microsoft.Maps.Events.addHandler(n,"viewchange",h)}function l(e,s){var o={title:s.DEPARTAMEN,projects:s.CODANEDEP,aproved:s.OBJECTID*999090},u=new t(n,{coords:e,fillColor:"rgba(158,52,158,"+r()+")",content:o});u.on("click",function(e,t){var n=t.getCoordinates();c(n[0],n[1])}),i.push(u)}function c(e,t){var r=Microsoft.Maps.LocationRect.fromCorners(e,t);n.setView({bounds:r})}function h(){n.getZoom()>o?i.forEach(function(e){e.hide()}):i.forEach(function(e){e.show()})}var n,i=[],s=this,o=6,u=!0;Microsoft.Maps.loadModule("Microsoft.Maps.Themes.BingTheme",{callback:a})}function r(){return(.3+.6*Math.random()).toFixed(2)}return n.prototype=new e,n});var map=null;require(["app/map/MapView"],function(e){new e(document.getElementById("map-div"))}),define("main",function(){});